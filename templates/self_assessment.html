{% extends "base.html" %}

{% block title %}Self Assessment - Peer Review App{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='profile.css') }}">
{% endblock %}

{% block content %}

<header class="topbar">
  <div class="logo-area">
    <img src="{{ url_for('static', filename='uni_logo-removebg-preview.png') }}" alt="University Logo">
  </div>
</header>

<div class="container" style="max-width: 800px; margin: 0 auto; padding: 20px;">
    <center>
        <h2>Self Assessment</h2>
        <div style="background: #e8f4fd; border: 1px solid #b3d9ff; border-radius: 8px; padding: 10px; margin: 10px 0;">
            <strong>Subject:</strong> {{ subject.name }} | <strong>Group:</strong> {{ group.name }}
        </div>
        <p style="color: #666; margin-bottom: 30px;">Please reflect on your group work experience with {{ group.name }}</p>
    </center>

    <!-- Flash Messages -->
    {% with messages = get_flashed_messages(with_categories=True) %}
        {% if messages %}
            {% for category, message in messages %}
                <div style="padding: 12px; margin: 15px 0; border-radius: 6px; border-left: 4px solid;
                            {% if category == 'error' %}
                                background: #f8d7da; color: #721c24; border-left-color: #dc3545;
                            {% elif category == 'success' %}
                                background: #d4edda; color: #155724; border-left-color: #28a745;
                            {% else %}
                                background: #d1ecf1; color: #0c5460; border-left-color: #17a2b8;
                            {% endif %}">
                    {{ message }}
                </div>
            {% endfor %}
        {% endif %}
    {% endwith %}

    <!-- Instructions -->
    <div style="background: #e8f4fd; border: 1px solid #b3d9ff; border-radius: 8px; padding: 15px; margin-bottom: 25px;">
        <h4 style="margin-top: 0; color: #0066cc;">üìù Self-Reflection Instructions</h4>
        <p style="color: #004085; margin-bottom: 0;">
            Take time to honestly assess your experience working in <strong>{{ group.name }}</strong> for <strong>{{ subject.name }}</strong>. 
            Your responses will help improve future collaborations and provide valuable insights for both you and your instructors.
        </p>
        {% if assessment_data %}
            <div style="margin-top: 10px; padding: 8px; background: #fff3cd; border-radius: 4px; color: #856404;">
                <small><strong>Note:</strong> You are editing your previous self-assessment for this group and subject.</small>
            </div>
        {% endif %}
    </div>
    
    <!-- Form -->
    <form action="{{ url_for('self_assessment', group_id=group.id, subject_id=subject.id) }}" method="POST">
        <div class="form-group">
            <label>1. Write a brief summary of your contribution to the {{ group.name }} group project for {{ subject.name }}:</label>
            <textarea name="summary" rows="4" class="input-area" required>{{ assessment_data.summary if assessment_data else '' }}</textarea>
        </div>
        <div class="form-group">
            <label>2. What challenges did you face while working with {{ group.name }} and what have you learned?</label>
            <textarea name="challenges" rows="4" class="input-area" required>{{ assessment_data.challenges if assessment_data else '' }}</textarea>
        </div>
        <div class="form-group">
            <label>3. What would you do differently if you could start over with {{ group.name }}?</label>
            <textarea name="different" rows="4" class="input-area" required>{{ assessment_data.different if assessment_data else '' }}</textarea>
        </div>
        <div class="form-group">
            <label>4. Describe your role in {{ group.name }} and how it helped the team:</label>
            <textarea name="role" rows="4" class="input-area" required>{{ assessment_data.role if assessment_data else '' }}</textarea>
        </div>
        <div class="form-group">
            <label>5. Additional feedback or comments about your experience in {{ group.name }} (optional):</label>
            <textarea name="feedback" rows="4" class="input-area">{{ assessment_data.feedback if assessment_data else '' }}</textarea>
        </div>
        <div style="text-align:center; margin-top: 30px;">
            <button type="submit" class="submit-btn">
                {% if assessment_data %}Update Assessment{% else %}Complete Assessment{% endif %}
            </button>
        </div>
    </form>
</div>

<style>
.form-group {
    margin-bottom: 25px;
}
.form-group label {
    display: block;
    margin-bottom: 8px;
    color: #333;
    font-weight: bold;
}
.input-area {
    width: 100%;
    padding: 12px;
    border: 1px solid #ccc;
    border-radius: 6px;
    font-family: inherit;
    resize: vertical;
}
.submit-btn {
    background: #28a745;
    color: white;
    padding: 12px 30px;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 16px;
    transition: background-color 0.3s;
}
.submit-btn:hover {
    background: #218838;
}
</style>
{% endblock %}
